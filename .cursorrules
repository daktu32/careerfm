# Career.fm Development Rules

## ğŸ¯ Project Context
Career.fm ã¯éŸ³å£°ååˆºã‚’ç”Ÿæˆãƒ»å…±æœ‰ã§ãã‚‹ Webã‚µãƒ¼ãƒ“ã‚¹ã§ã™ã€‚
AWS ã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¹ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ï¼ˆLambda + API Gateway + DynamoDBï¼‰ã§æ§‹ç¯‰ã•ã‚Œã¦ã„ã¾ã™ã€‚

## ğŸ“‹ Development Workflow

### æ–°æ©Ÿèƒ½è¿½åŠ ã®æ‰‹é †
1. **ä»•æ§˜æ›¸ä½œæˆ**: `docs/specs/F-XX-feature-name.md` ã«æ©Ÿèƒ½ä»•æ§˜ã‚’å…ˆã«ä½œæˆ
2. **TDDãƒ†ã‚¹ãƒˆ**: ãƒ†ã‚¹ãƒˆã‚’å…ˆã«ä½œæˆï¼ˆJest/React Testing Libraryï¼‰
3. **CDKæ›´æ–°**: å¿…è¦ã«å¿œã˜ã¦ `infrastructure/lib/stacks/` ã‚’æ›´æ–°
4. **Lambdaå®Ÿè£…**: `packages/backend/src/functions/` ã«å®Ÿè£…
5. **Frontendå®Ÿè£…**: `packages/frontend/src/` ã«å®Ÿè£…
6. **å‹å®šç¾©**: å…±é€šå‹ã¯ `types/` ã«è¿½åŠ 

### ãƒ•ã‚¡ã‚¤ãƒ«å‘½åè¦å‰‡
- æ©Ÿèƒ½ä»•æ§˜æ›¸: `F-XX-kebab-case-name.md`
- Lambdaé–¢æ•°: `kebab-case-name.ts`
- React ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ: `PascalCase.tsx`
- ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«: `*.test.ts` or `*.test.tsx`

## ğŸ› ï¸ Implementation Standards

### TypeScript Rules
- å³å¯†ãªå‹å®‰å…¨æ€§ã‚’ç¶­æŒ
- `any` å‹ã®ä½¿ç”¨ç¦æ­¢
- éåŒæœŸå‡¦ç†ã¯ async/await ã‚’ä½¿ç”¨
- ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã¯å¿…é ˆ

### AWS Lambda Design Patterns
- Cold Start ã‚’è€ƒæ…®ã—ãŸå®Ÿè£…
- DynamoDBClient ã¯é–¢æ•°å¤–ã§åˆæœŸåŒ–
- ç’°å¢ƒå¤‰æ•°ã®æ¤œè¨¼ã‚’èµ·å‹•æ™‚ã«å®Ÿæ–½
- Structured Logging (JSONå½¢å¼)

### Frontend Design Patterns
- Next.js App Router ã‚’ä½¿ç”¨
- Server Components ã‚’å„ªå…ˆ
- Client Components ã¯å¿…è¦æœ€å°é™
- TailwindCSS ã§ã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚°

### API Design
- RESTful åŸå‰‡ã«å¾“ã†
- JWT èªè¨¼ï¼ˆCognitoï¼‰
- ã‚¨ãƒ©ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã¯çµ±ä¸€ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
- CORS è¨­å®šã¯ API Gateway ã§ç®¡ç†

## ğŸ§ª Testing Requirements

### TDD Approach
- å®Ÿè£…å‰ã«ãƒ†ã‚¹ãƒˆã‚’æ›¸ã
- Red â†’ Green â†’ Refactor ã‚µã‚¤ã‚¯ãƒ«
- ã‚«ãƒãƒ¬ãƒƒã‚¸ç›®æ¨™: 80%ä»¥ä¸Š

### Test Categories
- **Unit Tests**: Jestï¼ˆLambda, Componentsï¼‰
- **Integration Tests**: API Gateway + Lambda
- **E2E Tests**: Playwrightï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ãƒ­ãƒ¼ï¼‰
- **CDK Tests**: CDK assertions

### Test Data
- ãƒ†ã‚¹ãƒˆãƒ•ã‚£ã‚¯ã‚¹ãƒãƒ£ã¯ `tests/fixtures/` ã«é…ç½®
- DynamoDB Local ã§ã®ãƒ†ã‚¹ãƒˆç’°å¢ƒ
- S3 Mockï¼ˆLocalStackï¼‰æ´»ç”¨

## ğŸ“ Documentation Rules

### Code Comments
- è¤‡é›‘ãªãƒ­ã‚¸ãƒƒã‚¯ã«ã¯æ—¥æœ¬èªã‚³ãƒ¡ãƒ³ãƒˆã‚’è¿½åŠ 
- é–¢æ•°/ã‚¯ãƒ©ã‚¹ã«ã¯ JSDoc ã‚³ãƒ¡ãƒ³ãƒˆã‚’è¨˜è¿°
- Lambda é–¢æ•°ã«ã¯å‡¦ç†æ¦‚è¦ã‚’æ˜è¨˜

### Architecture Updates
- æ©Ÿèƒ½å¤‰æ›´æ™‚ã¯ `docs/ARCHITECTURE.md` ã‚‚æ›´æ–°
- API å¤‰æ›´ã¯ OpenAPI ä»•æ§˜ã‚‚æ›´æ–°
- CDK å¤‰æ›´ã¯ README ã«åæ˜ 

## ğŸš« Prohibited Actions
- AWS èªè¨¼æƒ…å ±ã®ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰
- DynamoDB Scan ã®ç„¡åˆ¶é™ä½¿ç”¨
- S3 ã¸ã®ç›´æ¥ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ï¼ˆPresigned URL ã‚’ä½¿ç”¨ï¼‰
- ç’°å¢ƒå¤‰æ•°ã®ç›´æ¥å‚ç…§ï¼ˆè¨­å®šç®¡ç†ã‚’é€šã™ï¼‰
- package.json ã® dependencies ã‚’ç„¡æ–­ã§å¤‰æ›´ã—ãªã„

## ğŸ¯ Quality Standards

### Code Quality
- TypeScript ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚¨ãƒ©ãƒ¼ã‚¼ãƒ­
- ESLint ã‚¨ãƒ©ãƒ¼ã‚¼ãƒ­
- Prettier ã§ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆçµ±ä¸€
- æ–°æ©Ÿèƒ½ã¯å¯¾å¿œã™ã‚‹ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ã§ã‚«ãƒãƒ¼

### Performance Standards
- Lambda é–¢æ•°: ãƒ¡ãƒ¢ãƒª 512MB ä»¥ä¸‹ã§å‹•ä½œ
- API ãƒ¬ã‚¹ãƒãƒ³ã‚¹: 500ms ä»¥ä¸‹
- Frontend: Lighthouse ã‚¹ã‚³ã‚¢ 90ä»¥ä¸Š

### Security Standards
- èªè¨¼å¿…é ˆã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®ä¿è­·
- S3 ãƒã‚±ãƒƒãƒˆã¯éå…¬é–‹è¨­å®š
- æ©Ÿå¯†æƒ…å ±ã¯ AWS Secrets Manager
- æœ€å°æ¨©é™ã®åŸå‰‡ï¼ˆIAMï¼‰

## ğŸ“¦ Dependencies

### Package Management
- æ–°ã—ã„ npm ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸è¿½åŠ å‰ã«å¿…è¦æ€§ã‚’æ¤œè¨
- AWS SDK ã¯ v3 ã‚’ä½¿ç”¨
- è»½é‡ã§ä¿¡é ¼æ€§ã®é«˜ã„ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’å„ªå…ˆ
- ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è„†å¼±æ€§ãƒã‚§ãƒƒã‚¯å¿…é ˆ

### AWS Services
- æ–°ã‚µãƒ¼ãƒ“ã‚¹è¿½åŠ æ™‚ã¯ã‚³ã‚¹ãƒˆå½±éŸ¿ã‚’è©•ä¾¡
- ç„¡æ–™æ ã‚’æœ€å¤§é™æ´»ç”¨
- ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã¯ ap-northeast-1ï¼ˆæ±äº¬ï¼‰

## ğŸ”§ Build & Deploy

### Local Development
- `npm run dev` ã§ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰é–‹ç™º
- LocalStack ã§ AWS ã‚µãƒ¼ãƒ“ã‚¹ã‚’ã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆ
- ç’°å¢ƒå¤‰æ•°ã¯ `.env.local` ã§ç®¡ç†

### Deployment Checklist
- `npm run build` ã§ã‚¨ãƒ©ãƒ¼ãŒå‡ºãªã„ã“ã¨ã‚’ç¢ºèª
- `npm test` ã§ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆãŒé€šã‚‹ã“ã¨ã‚’ç¢ºèª
- `npx cdk diff` ã§å¤‰æ›´å†…å®¹ã‚’ç¢ºèª
- `npx cdk deploy` ã§ AWS ã«ãƒ‡ãƒ—ãƒ­ã‚¤

### Environment Management
- **dev**: é–‹ç™ºç’°å¢ƒï¼ˆå€‹äººã‚¢ã‚«ã‚¦ãƒ³ãƒˆï¼‰
- **staging**: ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ç’°å¢ƒ
- **prod**: æœ¬ç•ªç’°å¢ƒï¼ˆæ‰¿èªå¿…è¦ï¼‰

## ğŸµ Audio-Specific Guidelines

### Audio File Handling
- å¯¾å¿œå½¢å¼: MP3, WAV, M4A
- æœ€å¤§ã‚µã‚¤ã‚º: 10MB
- S3 ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã¯ Presigned URL çµŒç”±
- ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿æŠ½å‡ºã¨æ¤œè¨¼å¿…é ˆ

### Audio Player
- HTML5 Audio API ã‚’ä½¿ç”¨
- ãƒ—ãƒ­ã‚°ãƒ¬ãƒƒã‚·ãƒ–ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å¯¾å¿œ
- å†ç”Ÿã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
- ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£å¯¾å¿œï¼ˆã‚­ãƒ¼ãƒœãƒ¼ãƒ‰æ“ä½œï¼‰

## ğŸš€ Performance Optimization

### Frontend
- ç”»åƒã¯ Next.js Image ã§æœ€é©åŒ–
- éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«ã¯é…å»¶èª­ã¿è¾¼ã¿
- Critical CSS ã®ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³åŒ–

### Backend
- DynamoDB ã®é©åˆ‡ãªã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹è¨­è¨ˆ
- Lambda ã®ãƒ¡ãƒ¢ãƒªã‚µã‚¤ã‚ºæœ€é©åŒ–
- CloudFront ã‚­ãƒ£ãƒƒã‚·ãƒ¥æˆ¦ç•¥

## ğŸ“Š Monitoring & Logging

### Application Monitoring
- CloudWatch Logs ã§é›†ç´„
- X-Ray ã§ãƒˆãƒ¬ãƒ¼ã‚·ãƒ³ã‚°
- ã‚«ã‚¹ã‚¿ãƒ ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã§ KPI è¿½è·¡

### Error Tracking
- Lambda ã‚¨ãƒ©ãƒ¼ã¯ CloudWatch Alarms
- Frontend ã‚¨ãƒ©ãƒ¼ã¯ CloudWatch RUMï¼ˆå°†æ¥ï¼‰
- é‡è¦ã‚¨ãƒ©ãƒ¼ã¯ SNS é€šçŸ¥