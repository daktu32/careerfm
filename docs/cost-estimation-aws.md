# コスト試算書（AWS版）

バージョン: 1.0  
作成日: 2025-06-04  
プロジェクト: Career.fm MVP (AWS版)

---

## 1. 前提条件

### 1.1 利用規模（MVP）
- アクティブユーザー: 10名/月
- 音声名刺作成: 15件/月（1.5件/ユーザー）
- 音声ファイルサイズ: 平均 2MB/件
- 公開ページ閲覧: 300PV/月（20PV/音声名刺）
- データ保存期間: 無制限

### 1.2 計算期間
月額コスト（USD建て、2024年12月時点の料金）

### 1.3 AWS無料利用枠について
- 新規アカウント開設から **12ヶ月間** 適用
- 一部サービスは **常時無料枠** あり

---

## 2. サービス別コスト詳細

### 2.1 Amazon Cognito
| 項目 | 単価 | 利用量 | 月額コスト |
|------|------|---------|-----------|
| 月間アクティブユーザー | 常時無料枠: 50,000MAU/月 | 10ユーザー | **$0** |

**小計: $0**

### 2.2 AWS Lambda
| 項目 | 単価 | 利用量 | 月額コスト |
|------|------|---------|-----------|
| リクエスト数 | 常時無料枠: 100万回/月 | 500回 | **$0** |
| 実行時間（GB-秒） | 常時無料枠: 40万GB秒/月 | 1,000GB秒 | **$0** |

**小計: $0**

### 2.3 Amazon API Gateway
| 項目 | 単価 | 利用量 | 月額コスト |
|------|------|---------|-----------|
| REST API 呼び出し | $3.50/100万回 | 500回 | $0.002 |

**小計: $0.002**

### 2.4 Amazon DynamoDB
| 項目 | 単価 | 利用量 | 月額コスト |
|------|------|---------|-----------|
| ストレージ | 常時無料枠: 25GB/月 | 0.01GB | **$0** |
| 読み込み要求ユニット | 常時無料枠: 25RCU/月 | 5RCU | **$0** |
| 書き込み要求ユニット | 常時無料枠: 25WCU/月 | 2WCU | **$0** |

**小計: $0**

### 2.5 Amazon S3
| 項目 | 単価 | 利用量 | 月額コスト |
|------|------|---------|-----------|
| ストレージ（Standard） | 12ヶ月無料枠: 5GB/月 | 0.03GB（30MB） | **$0** |
| PUT リクエスト | 12ヶ月無料枠: 2,000回/月 | 100回 | **$0** |
| GET リクエスト | 12ヶ月無料枠: 20,000回/月 | 500回 | **$0** |

**小計: $0**

### 2.6 Amazon CloudFront
| 項目 | 単価 | 利用量 | 月額コスト |
|------|------|---------|-----------|
| データ転送（Out） | 常時無料枠: 1TB/月 | 0.6GB | **$0** |
| HTTP リクエスト | 常時無料枠: 1,000万回/月 | 800回 | **$0** |

**小計: $0**

### 2.7 Amazon SQS
| 項目 | 単価 | 利用量 | 月額コスト |
|------|------|---------|-----------|
| リクエスト数 | 常時無料枠: 100万回/月 | 100回 | **$0** |

**小計: $0**

### 2.8 Amazon CloudWatch
| 項目 | 単価 | 利用量 | 月額コスト |
|------|------|---------|-----------|
| ログ保存 | 常時無料枠: 5GB/月 | 0.1GB | **$0** |
| メトリクス | 常時無料枠: 10カスタムメトリクス | 5メトリクス | **$0** |

**小計: $0**

### 2.9 外部サービス

#### GitHub Actions
| 項目 | 単価 | 利用量 | 月額コスト |
|------|------|---------|-----------|
| Public リポジトリ | 無料 | 無制限 | **$0** |

**外部サービス小計: $0**

---

## 3. 総コスト

### 3.1 1年目（無料利用枠適用時）
| カテゴリ | 月額コスト |
|----------|-----------|
| AWS サービス | **$0.002** |
| 外部サービス | **$0** |
| **合計** | **$0.002** |

### 3.2 2年目以降（無料利用枠終了後）
| サービス | 1年目 | 2年目以降 | 差分 |
|----------|-------|-----------|------|
| Amazon S3 | $0 | $0.001 | +$0.001 |
| その他 | $0.002 | $0.002 | $0 |
| **合計** | **$0.002** | **$0.003** | **+$0.001** |

---

## 4. エラー追跡・モニタリング

### 4.1 AWS標準機能
- **CloudWatch Logs**: ログ集約・検索
- **CloudWatch Metrics**: カスタムメトリクス・アラート
- **X-Ray**: 分散トレーシング・パフォーマンス分析
- **CloudWatch Insights**: ログ分析・クエリ

### 4.2 実装例
```javascript
// CloudWatch Logs へのエラー送信
const AWS = require('aws-sdk');
const cloudWatchLogs = new AWS.CloudWatchLogs();

const logError = async (error, context) => {
  const params = {
    logGroupName: '/aws/lambda/career-fm-api',
    logStreamName: new Date().toISOString().split('T')[0],
    logEvents: [{
      timestamp: Date.now(),
      message: JSON.stringify({ error: error.message, context })
    }]
  };
  await cloudWatchLogs.putLogEvents(params).promise();
};
```

---

## 5. スケール時の試算

### 5.1 100ユーザー規模（6ヶ月後想定）
| サービス | MVP（10ユーザー） | 100ユーザー | 差分 |
|----------|------------------|-------------|------|
| Amazon Cognito | $0 | $0 | $0 |
| AWS Lambda | $0 | $0.8 | +$0.8 |
| API Gateway | $0.002 | $0.18 | +$0.178 |
| DynamoDB | $0 | $1.5 | +$1.5 |
| S3 | $0 | $0.1 | +$0.1 |
| CloudFront | $0 | $0.5 | +$0.5 |
| **合計** | **$0.002** | **$3.08** | **+$3.078** |

### 5.2 1,000ユーザー規模（1年後想定）
| サービス | 100ユーザー | 1,000ユーザー | 差分 |
|----------|-------------|---------------|------|
| AWS サービス | $3.08 | $28.5 | +$25.42 |
| 外部サービス | $0 | $0 | $0 |
| **合計** | **$3.08** | **$28.5** | **+$25.42** |

---

## 6. コスト最適化策

### 6.1 短期（MVP段階）
- AWS 無料利用枠を最大活用
- S3 Intelligent-Tiering でストレージコスト削減
- CloudFront キャッシュ最適化

### 6.2 中期（100ユーザー段階）
- DynamoDB オンデマンド → プロビジョニング済み容量検討
- S3 ライフサイクルポリシーで古いファイルをIA/Glacier移行
- Lambda 同時実行数制限でコスト制御

### 6.3 長期（1,000ユーザー段階）
- Reserved Capacity 活用検討
- リージョン最適化（レイテンシ vs コスト）
- マルチクラウド戦略検討

---

## 7. AWS vs Google Cloud コスト比較

| 規模 | AWS | Google Cloud | 差分 |
|------|-----|--------------|------|
| **MVP（10ユーザー）** | $0.002 | $0.076 | **AWS -$0.074** |
| **100ユーザー** | $3.08 | $9.05 | **AWS -$5.97** |
| **1,000ユーザー** | $28.5 | $73 | **AWS -$44.5** |

**AWSの方が全規模でコスト優位性あり**

---

## 8. 予算アラート設定

| しきい値 | アクション |
|----------|------------|
| $10/月 | メール通知 |
| $30/月 | Slack 通知 + レビュー |
| $60/月 | 緊急レビュー + 利用制限検討 |

---

## 9. 備考

### 9.1 注意事項
- AWS 無料利用枠は **新規アカウントのみ適用**
- S3等の12ヶ月制限に注意
- 為替レート変動リスク（USD建て料金）

### 9.2 初期コスト削減施策
- AWS Activate クレジット申請（スタートアップ向け）
- GitHub Student Pack 経由での AWS Credits
- 開発環境は LocalStack 活用

---

**最終更新**: 2025-06-04  
**次回見直し**: 2025-07-04
